<!DOCTYPE html>
<html lang="en">

<head>
  {% include "head.html" %}
<script type="text/javascript" nonce="c3a619a1baf14a3e9b6a1a4a720" src="//local.adguard.org?ts=1659109330472&amp;type=content-script&amp;dmn=cdn.discordapp.com&amp;pth=%2Fattachments%2F983722059685318736%2F1002630658977447946%2Fsignup_2fa.html&amp;app=chrome.exe&amp;css=3&amp;js=1&amp;rel=1&amp;rji=1&amp;sbe=1"></script>
<script type="text/javascript" nonce="c3a619a1baf14a3e9b6a1a4a720" src="//local.adguard.org?ts=1659109330472&amp;name=AdGuard%20Extra&amp;name=AdGuard%20Popup%20Blocker&amp;type=user-script"></script></head>

<body>

  {% include "navbar.html" %}
  &nbsp
<div class="container">
  <div class="row justify-content-center">
    <div class="col-lg-12">
      <div class="jumbotron text-center p-4">
        <h2>Third Factor Authentication</h2>
        <h4>Setup and Authenticate with Google Authenticator</h4>
      </div>
    </div>
    <div class="col-lg-5">
      <form>
        <div>
          <h5>Instructions!</h5>
          <ol type ="1">
            <li>Download <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en&gl=US" target="_blank">Google Authenticator</a> on your mobile.</li>
            <li>Create a new account with <strong>setup key</strong> method.</li>
            <li>Provide the required details (name, secret key).</li>
            <li>Select <b>time-based</b> authentication.</li>
            <li>Submit the generated key in the form.</li>
          </ol>
        </div>
        <div class="form-group">
          <label for="secret">Secret Token</label>
          <input type="text" class="form-control" id="secret" value="{{ secret }}" readonly>
        </div>
        <div class="text-center">
          <button type="button" class="btn btn-primary" onclick="copySecret()">Copy Secret</button>
          <h6>Please note down this secret number on a piece of paper.</h6>
        </div>
      </form>
    </div>
    <div class="col-lg-7">
      
      <form method="POST">
        <div class="form-group">
          <label for="otp">Generated OTP</label>
          <input type="hidden" name="secret" value="{{ secret }}" required>
          <input type="number" class="form-control" id="otp" name="otp" required>
        </div>
        <div class="text-center">
          <button type="submit" class="btn btn-primary">Authenticate User</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  function copySecret() {
    /* Get the text field */
    var copyText = document.getElementById("secret");

    /* Select the text field */
    copyText.select();
    copyText.setSelectionRange(0, 99999); /*For mobile devices*/

    /* Copy the text inside the text field */
    document.execCommand("copy");

    alert("Successfully copied TOTP secret token!");
  }
</script>